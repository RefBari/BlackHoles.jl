<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Physics of Schwarzschild Metric · BlackHoles.jl</title><meta name="title" content="Physics of Schwarzschild Metric · BlackHoles.jl"/><meta property="og:title" content="Physics of Schwarzschild Metric · BlackHoles.jl"/><meta property="twitter:title" content="Physics of Schwarzschild Metric · BlackHoles.jl"/><meta name="description" content="Documentation for BlackHoles.jl."/><meta property="og:description" content="Documentation for BlackHoles.jl."/><meta property="twitter:description" content="Documentation for BlackHoles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BlackHoles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Conservative Dynamics</span><ul><li><a class="tocitem" href="../newtonian-metric/">Physics of Newtonian Metric</a></li><li class="is-active"><a class="tocitem" href>Physics of Schwarzschild Metric</a></li><li><a class="tocitem" href="../orbits/">Simulating Orbits in Schwarzschild Metric</a></li><li><a class="tocitem" href="../waveforms/">Quadrupole Approximation: Orbits to Gravitational Wave</a></li><li><a class="tocitem" href="../higher_modes/">Adding Higher Order Modes</a></li><li><a class="tocitem" href="../inverse_problem/">Fundamentals of Neural Networks</a></li><li><a class="tocitem" href="../sanity_checks/">Sanity Checks</a></li></ul></li><li><span class="tocitem">Dissipative Dynamics</span><ul><li><a class="tocitem" href="../GENERIC/">Theory: GENERIC Formalism</a></li><li><a class="tocitem" href="../dissipative_orbits/">Simulating Orbits with GENERIC</a></li><li><a class="tocitem" href="../full_inverse_problem/">Dissipative Case: Waves to Orbits</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Conservative Dynamics</a></li><li class="is-active"><a href>Physics of Schwarzschild Metric</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Physics of Schwarzschild Metric</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/RefBari/BlackHoles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/RefBari/BlackHoles.jl/blob/main/docs/src/guide/schwarzschild-metric.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Schwarzschild-Metric"><a class="docs-heading-anchor" href="#Schwarzschild-Metric">Schwarzschild Metric</a><a id="Schwarzschild-Metric-1"></a><a class="docs-heading-anchor-permalink" href="#Schwarzschild-Metric" title="Permalink"></a></h1><p>The goal of this module is to generate conservative dynamics training data for the Neural ODE. In particular, this training module will generate the gravitational waveforms associated with two Schwarzschild black holes orbiting each other. These waveforms will subsequently be used as training data for the Neural ODE, which will attempt to reconstruct the orbits. In doing so, the Neural ODE will attempt to learn the Scwhwarzschild Metric from a Newtonian weak-field metric. </p><p>In other words, this module will provide a step-by-step guide to creating a function that has the following input and output: </p><div class="admonition is-info" id="Generate-Schwarzschild-Gravitational-Waves-Function-a98162d3150197ae"><header class="admonition-header">Generate Schwarzschild Gravitational Waves Function<a class="admonition-anchor" href="#Generate-Schwarzschild-Gravitational-Waves-Function-a98162d3150197ae" title="Permalink"></a></header><div class="admonition-body"><p>The <code>Generate_Schwarzschild_GWs()</code> function will operate as follows: </p><ul><li>Goal: Generate training data for conservative dynamics of binary black hole system that will be fed to Neural ODE</li><li>Input: Mass Ratio <span>$q=m_2/m_1$</span> &amp; Initial Conditions <span>$\dot{x}(0)$</span></li><li>Output: True Orbits <span>$(x_1(t), y_1(t))$</span> and <span>$(x_2(t), y_2(t))$</span> of a binary black hole system and the associated gravitational waveform <span>$h(t)$</span>. </li></ul></div></div><p>We seek to describe the two body problem in general relativity. In particular, we seek the equations of motion for two body dynamics. In the limit that one black hole is much larger than the other, we can describe the smaller black hole as a particle following geodesics of the Schwarzschild metric around the larger black hole. We now proceed to describe how the two body problem can thus be reduced to an effective one-body problem. Plot:</p><p><img src="../Orbits2Waves_Final.png" alt="TestingOrbits"/></p><p>Consider two black holes of masses <span>$m_1$</span> and <span>$m_2$</span> orbiting around their common center-of-mass. We have two cases: </p><blockquote><ul><li><p class="math-container">\[m_1&gt;&gt;m_2\]</p>: The equivalent one-body picture is a particle orbiting a central Schwarzschild black hole of mass <span>$M=m_1+m_2$</span></li><li><p class="math-container">\[m_1\sim m_2:\]</p>The equivalent one-body picture is a given by the Effective One-Body formalism, wherein the two-body dynamics is mapped to a single-body of reduced mass <span>$\mu=m_1m_2 / (m_1+m_2)$</span> orbiting a central mass <span>$M = m_1+m_2$</span>.</li></ul></blockquote><p>For reasons of simplicity and application to EMRIs, we will focus on the first option above. Our approach will be as follows: to describe the dynamics of the binary black hole system, we will transform to an effective one-body problem as per the <span>$m_1&gt;&gt;m_2$</span> case above, and then subsequently transform back to the two-body problem. The Hamiltonian describing a particle orbiting a Schwarzschild black hole is </p><p class="math-container">\[H = \frac{p^2}{2}= \frac{1}{2}p^\mu g_{\mu \nu} p^\nu\]</p><p>The Schwarzschild Metric <span>$g_{\mu\nu}$</span> is </p><p class="math-container">\[g^{\text{Schwarzschild}}_{\mu\nu} = 
\begin{pmatrix}
    -\left(1-\frac{2M}{r} \right) &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; \left(1-\frac{2M}{r} \right)^{-1} &amp; 0 &amp; 0 \\ 
    0  &amp; 0 &amp; r^2 &amp; 0 \\ 
    0 &amp; 0 &amp; 0 &amp; r^2 \sin^2 \theta
\end{pmatrix}\]</p><p>Thus, the Hamiltonian for the Schwarzschild Metric is </p><p class="math-container">\[H_{Schwarzschild}=- \left(1-\frac{2M}{r}\right)^{-1}\frac{p_t^2}{2} + \left(1-\frac{2M}{r}\right) \frac{p_r^2}{2} + \frac{p_\phi^2}{2r^2}\]</p><p class="math-container">\[H=\frac{1}{2}\left(p_t, p_r, p_\theta, p_\phi \right)^T \begin{pmatrix}
    -\left(1-\frac{2M}{r}\right)^{-1} &amp; 0 &amp; 0 &amp; 0\\
    0 &amp; \left(1-\frac{2M}{r}\right) &amp; 0 &amp; 0 \\ 
    0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; r^{-2}
    \end{pmatrix}	 
    \left(p_t, p_r, p_\theta, p_\phi \right)\]</p><p>We formulate this in Julia as follows: </p><pre><code class="language-julia hljs">function H(state_vec)
        t, r, θ, φ, p_t, p_r, p_θ, p_ϕ = state_vec

        f = (1 - (2/r))
        p = [p_t, p_r, p_θ, p_ϕ]
        g = [
                -f^(-1) 0 0 0;
                0 f 0 0;
                0 0 0 0;
                0 0 0 r^(-2)
            ]

        H_schwarzschild = (1/2) * p&#39; * g * p

        return H_schwarzschild # Returns equations of motion in _proper_ time
    end</code></pre><p>We can now use Hamilton&#39;s Equations of Motion to obtain the orbit: </p><p class="math-container">\[\dot{q}=\frac{\partial H}{\partial p}, -\dot{p}=\frac{\partial H}{\partial q}\]</p><p>Thus, for a particle on an equatorial orbit around a Schwarzschild black hole, we obtain the following geodesic equations of motion: </p><p class="math-container">\[\frac{dt}{d\tau} = \left(1-\frac{2M}{r}\right)^{-1}E, \frac{dr}{d\tau} = \left(1-\frac{2M}{r}\right){p_r}, \frac{d\theta}{d\tau} =0, \frac{d\phi}{d\tau} = \frac{L}{r^2}\]</p><p>Similarly, the momentum vector <span>$p^{\mu}$</span> evolves as</p><p class="math-container">\[\frac{dp_t}{d\tau} = \dot E = 0\]</p><p class="math-container">\[\frac{dp_r}{d\tau} =  -\frac{1}{2}\left[\left(1-\frac{2M}{r}\right)^{-2}\left( \frac{2M}{r^2}\right) (p_t)^2 + \frac{2M}{r^2}(p_r)^2-2r^{-3} (p_{\phi})^2\right]\]</p><p class="math-container">\[\dot p_\theta = 0, \dot p_\phi = \dot L = 0\]</p><p>We have thus obtained all the equations of motion for a test particle orbiting a Schwarzschild Black Hole. In Julia, this is simply: </p><pre><code class="language-julia hljs">grad_H = ForwardDiff.gradient(H, x)

L = [
        zeros(4, 4) I(4);
        -I(4) zeros(4, 4)
    ]

Conservative = L * grad_H</code></pre><p>In General Relativity, there are two kinds of time: the proper time and coordinate time. There remains a subtle step: Our trajectories are parametrized in terms of proper time <span>$\tau$</span>. To convert back to coordinate time, which is the time measured by a detector here on Earth, we must multiply the equations of motion by a conversion factor. For instance:</p><p class="math-container">\[\frac{dr}{dt}=\frac{dr}{d\tau}\frac{d\tau}{dt}=\frac{dr}{d\tau}\left(\frac{dt}{d\tau}\right)^{-1}=\frac{dr}{d\tau}\left(\frac{\partial H}{\partial p_t}\right)^{-1}\]</p><p>In Julia, we formulate this as: </p><pre><code class="language-julia hljs">dx_dτ = Conservative

dH_dpₜ = grad_H[5]
dτ_dt = (dH_dpₜ)^(-1)

for i = 1:8
    dx[i] = dx_dτ[i] * dτ_dt
end</code></pre><p>Now that we have all the equations of motion, we return them as an output of the <code>GENERIC()</code> function:</p><pre><code class="language-julia hljs">function GENERIC(du, u, model_params, t;
                              NN=nothing, NN_params=nothing)
    x = u[1:8]
    q = mass_ratio
    M = 1.0

    function H(state_vec)
        # Returns Schwarzschild Hamiltonian
        H_schwarzschild = (1/2) * p&#39; * g * p
        return H_schwarzschild
    end

    # ... [Use Hamilton Equations to get equations of motion]

    # Return equations of motion
    return [du[1], du[2], du[3], du[4], du[5], du[6], du[7], du[8]]
end</code></pre><p>Now that we have the <code>GENERIC()</code> function, we extract the ODEs from it: </p><pre><code class="language-julia hljs">function ODE_model_dual(du, u, p, t)
    du = GENERIC(du, u, model_params, t)
    return du
end</code></pre><p>Now we define the ODE problem, solve it, and convert it to a waveform!</p><pre><code class="language-julia hljs">prob = ODEProblem(ODE_model_dual, u0, tspan)
soln = Array(solve(prob, Tsit5(), saveat = tsteps, dt = dt, adaptive=false, verbose=false))
gw = compute_waveform(soln)</code></pre><p>How do we actually visualize the orbits? We can plot the effective one-body orbit via </p><pre><code class="language-julia hljs">orbit = soln2orbit(soln)
plot(orbit[1,:], orbit[2,:], aspect_ratio=:equal)</code></pre><p><code>soln2orbit()</code> is simply a function which extracts the <span>$(r,\phi)$</span> components of the state vector solution and converts them to <span>$(x,y)$</span>: </p><pre><code class="language-julia hljs">function soln2orbit(soln, model_params=nothing)
    #=
        Performs change of variables:
        (r(t),ϕ(t)) ↦ (x(t),y(t))
    =#

    r = soln[2,:] # radial coordinate solutions
    ϕ = soln[4,:] # planar angle solutions

    x = r .* cos.(ϕ)
    y = r .* sin.(ϕ)

    orbit = [x&#39;; y&#39;]
    return orbit
end</code></pre><p>To visualize the actual, original 2-body problem of the two binary black holes, we use the <code>one2two()</code> function, which implements the following transformation to go from the state vector of the effective one body problem <span>$r(t)$</span> to the state vectors of the two body problem:  <span>$M = m_1 + m_2, r_1 = \frac{m_2}{M} * \text{path}, r_2 = -\frac{m_1}{M} * \text{path}$</span></p><p>Why is it that <span>$r_1 \propto m_2$</span> and vice-versa? This can be easily understood: In the limiting case that <span>$m_2&gt;&gt;m_1, q=1, M\sim m_2$</span>. Thus, <span>$r_1 \sim 1*\text{path}, r_2 \sim 0$</span>. This is reasonable, as the second mass has negligible motion if its much more massive than the first mass. In Julia, this becomes:</p><pre><code class="language-julia hljs">function one2two(path, m1, m2)
    #=
        We need a very crude 2-body path

        Assume the 1-body motion is a newtonian 2-body position vector r = r1 - r2
        and use Newtonian formulas to get r1, r2
        (e.g. Theoretical Mechanics of Particles and Continua 4.3)
    =#

    M = m1 + m2
    r1 = m2/M .* path
    r2 = -m1/M .* path

    return r1, r2
end</code></pre><p>Finally, if we&#39;d like to obtain the gravitational wave from the two-body dynamics instead of the effective one-body dynamics (a good sanity check that they result in the same <span>$h(t)$</span>), we can employ: </p><pre><code class="language-julia hljs">h_plus_true, h_cross_true = h_22_strain_two_body(dt_data, blackHole_r1, mass1, blackHole_r2, mass2)</code></pre><p>That&#39;s it! We&#39;re done! We&#39;ve generated the orbits and waveforms associated with the Schwarzschild Metric! <img src="../ThickOrbits.png" alt="TestingOrbits"/> <img src="../Orbits_Test2.png" alt="TestingOrbits"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../newtonian-metric/">« Physics of Newtonian Metric</a><a class="docs-footer-nextpage" href="../orbits/">Simulating Orbits in Schwarzschild Metric »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 24 January 2026 15:59">Saturday 24 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
